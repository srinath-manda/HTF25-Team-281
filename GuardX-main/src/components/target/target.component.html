<div class="animate-fade-in">
  <div class="flex justify-between items-center mb-6">
    <h2 class="text-3xl font-bold text-white">Target: The Vault Online Store</h2>
    <div class="flex items-center space-x-4">
        <div class="flex items-center space-x-2 px-3 py-1 rounded-full" [class]="getSecurityLevelClass(securityLevel())">
            <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M10 2.25c-4.223 0-7.406 2.033-8.413 5.06a.75.75 0 0 0 .68 1.032l.332-.058C3.39 8.163 4.25 7.5 5.5 7.5c2.071 0 3.75 1.679 3.75 3.75S7.571 15 5.5 15c-1.25 0-2.11-.663-2.902-1.784l-.332-.058a.75.75 0 0 0-.68 1.032C2.594 17.717 5.777 19.75 10 19.75c4.013 0 7.33-2.343 8.343-5.635a.75.75 0 0 0-.68-1.032l-.332.058C16.61 13.263 15.75 13.75 14.5 13.75c-2.071 0-3.75-1.679-3.75-3.75s1.679-3.75 3.75-3.75c1.25 0 2.11.663 2.902 1.784l.332.058a.75.75 0 0 0 .68-1.032C17.33 4.593 14.013 2.25 10 2.25Z" clip-rule="evenodd" />
            </svg>
            <span class="text-sm font-semibold">Security Level: {{ securityLevel() }}</span>
        </div>
        @if(firewallEnabled()) {
            <div class="flex items-center space-x-2 px-3 py-1 rounded-full bg-green-500/20 text-green-300">
                <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10 1a4.5 4.5 0 00-4.5 4.5V9H5a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2h-.5V5.5A4.5 4.5 0 0010 1zm3 8V5.5a3 3 0 10-6 0V9h6z" clip-rule="evenodd" />
                </svg>
                <span class="text-sm font-semibold">Site is Secured by GuardX</span>
            </div>
        } @else {
            <div class="flex items-center space-x-2 px-3 py-1 rounded-full bg-red-500/20 text-red-300 animate-pulse">
                <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M10 1a4.5 4.5 0 00-4.5 4.5V9H5a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2h-.5V5.5A4.5 4.5 0 0010 1zm-3 8V5.5a3 3 0 116 0V9H7z" clip-rule="evenodd" />
                  <path d="M11 5.5a1 1 0 10-2 0V9h2V5.5z" />
                </svg>
                <span class="text-sm font-semibold">WARNING: Firewall Disabled</span>
            </div>
        }
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
    <!-- Product Info -->
    <div class="lg:col-span-2 bg-gray-800 p-6 rounded-lg border border-gray-700">
      <img src="https://picsum.photos/seed/gadget/800/400" alt="Product Image" class="w-full h-64 object-cover rounded-lg mb-4">
      <h3 class="text-2xl font-bold text-cyan-400">{{ productDetails().name }}</h3>
      <p class="text-gray-400 mt-2">{{ productDetails().description }}</p>
      <div class="mt-4 text-4xl font-bold text-white">${{ productDetails().price.toFixed(2) }}</div>
    </div>

    <!-- Login & Status -->
    <div class="lg:col-span-1 space-y-6">
       <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
          <h3 class="text-xl font-semibold text-white mb-4">User Login</h3>
           <div class="mb-4">
              <label for="username" class="block text-sm font-medium text-gray-300 mb-2">Username</label>
              <input type="text" id="username" placeholder="Enter username" class="w-full bg-gray-900 border border-gray-600 rounded-md p-2 text-gray-200 focus:ring-cyan-400 focus:border-cyan-400">
           </div>
           <div class="mb-4">
              <label for="password" class="block text-sm font-medium text-gray-300 mb-2">Password</label>
              <input type="password" id="password" placeholder="Enter password" class="w-full bg-gray-900 border border-gray-600 rounded-md p-2 text-gray-200 focus:ring-cyan-400 focus:border-cyan-400">
           </div>
           <p class="text-sm text-center">Status: <span class="font-bold" [class]="getLoginStatusClass(loginStatus())">{{ loginStatus() }}</span></p>
           <p class="text-xs text-gray-500 text-center mt-2">Use Attacker Tools to attempt login.</p>
        </div>
        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
            <h3 class="text-xl font-semibold text-white mb-4">Site Health</h3>
            <ul class="space-y-2 text-sm text-gray-300">
                <li class="flex items-center"><svg class="w-4 h-4 mr-2 text-green-400" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>Database Connection: OK</li>
                <li class="flex items-center"><svg class="w-4 h-4 mr-2 text-green-400" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>API Services: Operational</li>
                <li class="flex items-center"><svg class="w-4 h-4 mr-2 text-green-400" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>SSL Certificate: Valid</li>
            </ul>
        </div>
    </div>
  </div>

  <!-- Reviews Section -->
  <div class="mt-8 bg-gray-800 p-6 rounded-lg border border-gray-700">
    <h3 class="text-xl font-semibold text-white mb-4">Customer Reviews</h3>
    <div class="space-y-4 max-h-96 overflow-y-auto pr-2">
      @for(comment of comments(); track comment) {
        <div class="p-4 bg-gray-900/50 border border-gray-700 rounded-lg">
          <div class="flex items-center mb-2">
            <img src="https://i.pravatar.cc/32?u={{comment}}" class="w-8 h-8 rounded-full mr-3">
            <span class="font-semibold text-cyan-300">User-{{ comment.length % 1000 }}</span>
          </div>
          <!-- This is the vulnerable part for the XSS demo -->
          <p class="text-gray-300" [innerHTML]="sanitizeAndTrustHtml(comment)"></p>
        </div>
      } @empty {
        <p class="text-gray-500 text-center py-4">No reviews yet.</p>
      }
    </div>
     <p class="text-xs text-gray-500 text-center mt-4">Use Attacker Tools to post a new review.</p>
  </div>
</div>
